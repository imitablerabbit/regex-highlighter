var Match=function(a,b,c,d,e,f){this.index=a,this.classes=b,this.type=c,this.length=d,this.match=e,this.precedence=f},RegexHighlighter=function(a){this.returnClassName=a,"undefined"==typeof this.returnClassName&&(this.returnClassName="regex-highlight")};RegexHighlighter.prototype.sortArrayByObjectsIndex=function(a){a.sort(function(b,c){return b.index==c.index?b.precedence-c.precedence:b.index-c.index})},RegexHighlighter.prototype.removeDuplicateObjectsFromArray=function(a,b){for(var c=1;c<a.length;c++){var d=b(a[c-1],a[c]);0!=d&&(d<0?(a.splice(c-1,1),c--):(a.splice(c,1),c--))}},RegexHighlighter.prototype.wrapTextWithSpan=function(a,b,c,d){if("undefined"==typeof a)return!1;"undefined"==typeof b&&(b=""),"undefined"==typeof c&&(c=0),"undefined"==typeof d&&(d=a.length);var e=a.substring(0,c),f=a.substring(c,d),g=a.substring(d);return e+"<span class='"+b+"'>"+f+"</span>"+g},RegexHighlighter.prototype.getMatchesArrayFromRegex=function(a,b){for(var c=[],d=1,e=0;e<a.length;e++){var i,f=a[e],g=f.type,h=f.regexes;if(f.precedence){if(isNaN(f.precedence)){for(var j=!1,k=0;k<c.length;k++)if(f.precedence==c[k].type){i=c[k].precedence,j=!0;break}j||(i=d)}else i=parseInt(f.precedence);d--}else i=d;for(var k=0;k<h.length;k++){var l,m;"string"==typeof h[k]?(l=h[k],m=0):(l=h[k].regexString,m=h[k].captureGroup);var n=this.findRegexMatches(b,l,m,g,i);c.push.apply(c,n)}d++}return c},RegexHighlighter.prototype.findRegexMatches=function(a,b,c,d,e){for(var f=[],g=new RegExp(b,"gm");match=g.exec(a);){var h=match.index;c>=match.length&&(c=0);var i=match[c],j=match[0].indexOf(i);matchObject=new Match(h+j,this.returnClassName+" "+d,d,i.length,i,e),f.push(matchObject)}return f},RegexHighlighter.prototype.defaultDuplicateFunction=function(a,b){return a.index==b.index?a.precedence==b.precedence?a.length==b.length?-1:a.length-b.length:a.precedence-b.precedence:b.index>a.index&&b.index+b.length<a.index+a.length?1:b.index>a.index&&b.index<a.index+a.length&&b.index+b.length>=a.index+a.length?a.precedence!=b.precedence?a.precedence-b.precedence:a.length!=b.length?a.length-b.length:-1:0},RegexHighlighter.prototype.insertSyntaxHighlighting=function(a,b,c){"undefined"==typeof c&&(c=this.defaultDuplicateFunction),b=b.replaceAll("<br>","\n");var d=this.getMatchesArrayFromRegex(a,b);return this.sortArrayByObjectsIndex(d),this.removeDuplicateObjectsFromArray(d,c),this.assembleNewStringFromMatchArray(b,d)},RegexHighlighter.prototype.insertSyntaxHighlightingByClass=function(a,b){if("undefined"==typeof a)return!1;"undefined"==typeof b&&(b="regex-color");for(var c=document.getElementsByClassName(b),e=0;e<c.length;e++){var f=c[e],g=f.innerHTML;result=this.insertSyntaxHighlighting(a,g),result&&(f.innerHTML=result)}return!0},RegexHighlighter.prototype.loadSyntaxHighlightingByClass=function(a,b){"undefined"==typeof b&&(b="languages/"),"undefined"==typeof a&&(a="regex-color");for(var c=document.getElementsByClassName(a),d=0;d<c.length;d++){var e=c[d],f=e.className.split(" ");if(f.length>1){var g=f[1];this.ajaxGET(b+g+".json",function(a,b){var c=JSON.parse(a),d=this.insertSyntaxHighlighting(c,b.innerHTML);d&&(b.innerHTML=d)}.bind(this),e)}}},RegexHighlighter.prototype.assembleNewStringFromMatchArray=function(a,b){for(var c=0,d=0;d<b.length;d++){var e=b[d],f=e.index+c,g=e.classes,h=e.length;a=this.wrapTextWithSpan(a,g,f,f+h),c+=("<span class=''></span>"+g).length}return a},RegexHighlighter.prototype.ajaxGET=function(a,b,c){var d=new XMLHttpRequest;d.onreadystatechange=function(){4==d.readyState&&200==d.status&&b(d.responseText,c)},d.open("GET",a,!0),d.send()},String.prototype.replaceAll=function(a,b){var c=this;return c.replace(new RegExp(a,"g"),b)};
